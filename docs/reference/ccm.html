<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform convergent cross mapping using simplex projection — ccm • rEDM</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Perform convergent cross mapping using simplex projection — ccm" />

<meta property="og:description" content="ccm uses time delay embedding on one time series to generate an 
attractor reconstruction, and then applies the simplex projection algorithm 
to estimate concurrent values of another time series. This method is 
typically applied, varying the library sizes, to determine if one time series
contains the necessary dynamic information to recover the influence of 
another, causal variable." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rEDM</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/rEDM-coprediction.html">co-prediction: using rEDM to quantify dynamic similarity</a>
    </li>
    <li>
      <a href="../articles/rEDM-time-delay-ccm.html">Using rEDM to quantify time delays in causation</a>
    </li>
    <li>
      <a href="../articles/rEDM-tutorial.html">rEDM: An R package for Empirical Dynamic Modeling and Convergent Cross Mapping</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform convergent cross mapping using simplex projection</h1>
    
    <div class="hidden name"><code>ccm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>ccm</code> uses time delay embedding on one time series to generate an 
attractor reconstruction, and then applies the simplex projection algorithm 
to estimate concurrent values of another time series. This method is 
typically applied, varying the library sizes, to determine if one time series
contains the necessary dynamic information to recover the influence of 
another, causal variable.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ccm</span>(<span class='no'>block</span>, <span class='kw'>lib</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fu'>NROW</span>(<span class='no'>block</span>)), <span class='kw'>pred</span> <span class='kw'>=</span> <span class='no'>lib</span>, <span class='kw'>norm</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>E</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>tau</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>tp</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>num_neighbors</span> <span class='kw'>=</span> <span class='st'>"e+1"</span>, <span class='kw'>lib_sizes</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>10</span>, <span class='fl'>100</span>, <span class='kw'>by</span> <span class='kw'>=</span>
  <span class='fl'>10</span>), <span class='kw'>random_libs</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>num_samples</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>lib_column</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>target_column</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>first_column_time</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>RNGseed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>exclusion_radius</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>epsilon</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>silent</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>block</th>
      <td><p>either a vector to be used as the time series, or a 
data.frame or matrix where each column is a time series</p></td>
    </tr>
    <tr>
      <th>lib</th>
      <td><p>a 2-column matrix (or 2-element vector) where each row specifies 
the first and last *rows* of the time series to use for attractor 
reconstruction</p></td>
    </tr>
    <tr>
      <th>pred</th>
      <td><p>(same format as lib), but specifying the sections of the time 
series to forecast.</p></td>
    </tr>
    <tr>
      <th>norm</th>
      <td><p>the distance measure to use. see 'Details'</p></td>
    </tr>
    <tr>
      <th>E</th>
      <td><p>the embedding dimensions to use for time delay embedding</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p>the lag to use for time delay embedding</p></td>
    </tr>
    <tr>
      <th>tp</th>
      <td><p>the prediction horizon (how far ahead to forecast)</p></td>
    </tr>
    <tr>
      <th>num_neighbors</th>
      <td><p>the number of nearest neighbors to use. Note that the 
default value will change depending on the method selected. (any of "e+1", 
"E+1", "e + 1", "E + 1" will peg this parameter to E+1 for each run, any
value &lt; 1 will use all possible neighbors.)</p></td>
    </tr>
    <tr>
      <th>lib_sizes</th>
      <td><p>the vector of library sizes to try</p></td>
    </tr>
    <tr>
      <th>random_libs</th>
      <td><p>indicates whether to use randomly sampled libs</p></td>
    </tr>
    <tr>
      <th>num_samples</th>
      <td><p>is the number of random samples at each lib size (this 
parameter is ignored if random_libs is FALSE)</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>indicates whether to sample vectors with replacement</p></td>
    </tr>
    <tr>
      <th>lib_column</th>
      <td><p>the index (or name) of the column to cross map from</p></td>
    </tr>
    <tr>
      <th>target_column</th>
      <td><p>the index (or name) of the column to forecast</p></td>
    </tr>
    <tr>
      <th>first_column_time</th>
      <td><p>indicates whether the first column of the given 
block is a time column (and therefore excluded when indexing)</p></td>
    </tr>
    <tr>
      <th>RNGseed</th>
      <td><p>will set a seed for the random number generator, enabling 
reproducible runs of ccm with randomly generated libraries</p></td>
    </tr>
    <tr>
      <th>exclusion_radius</th>
      <td><p>excludes vectors from the search space of nearest 
neighbors if their *time index* is within exclusion_radius (NULL turns 
this option off)</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>excludes vectors from the search space of nearest neighbors 
if their *distance* is farther away than epsilon (NULL turns this option 
off)</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>prevents warning messages from being printed to the R console</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with forecast statistics for the different parameter 
  settings:</p><table class='table'>
<tr><td><code>L</code></td><td>library length (number of vectors)</td></tr>
<tr><td><code>num_pred</code></td><td>number of predictions</td></tr>
<tr><td><code>rho</code></td><td>correlation coefficient between observations and predictions</td></tr>
<tr><td><code>mae</code></td><td>mean absolute error</td></tr>
<tr><td><code>rmse</code></td><td>root mean square error</td></tr>
</table>


    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The default parameters are set so that passing a matrix as the only argument
will use E = 1 (embedding dimension), and leave-one-out cross-validation over
the whole time series to compute cross-mapping from the first column to the 
second column, letting the library size vary from 10 to 100 in increments of 
10.</p>
<p><code>norm = 2</code> (default) uses the "L2 norm", Euclidean distance:
  $$distance(a,b) := \sqrt{\sum_i{(a_i - b_i)^2}}
    $$
<code>norm = 1</code> uses the "L1 norm", Manhattan distance:
  $$distance(a,b) := \sum_i{|a_i - b_i|}
    $$
Other values generalize the L1 and L2 norm to use the given argument as the 
  exponent, P, as:
  $$distance(a,b) := \sum_i{(a_i - b_i)^P}^{1/P}
    $$</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='st'>"sardine_anchovy_sst"</span>)
<span class='no'>anchovy_xmap_sst</span> <span class='kw'>&lt;-</span> <span class='fu'>ccm</span>(<span class='no'>sardine_anchovy_sst</span>, <span class='kw'>E</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>lib_column</span> <span class='kw'>=</span> <span class='st'>"anchovy"</span>, <span class='kw'>target_column</span> <span class='kw'>=</span> <span class='st'>"np_sst"</span>,
  <span class='kw'>lib_sizes</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>10</span>, <span class='fl'>80</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>num_samples</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Note: CCM results are typically interpreted in the opposite direction of causation. Please see 'Detecting causality in complex ecosystems' (Sugihara et al. 2012) for more details.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Found overlap between lib and pred. Enabling cross-validation with exclusion radius = 0.</span></div><div class='input'> 
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Hao Ye, Adam Clark, Ethan Deyle, Steve Munch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

